<?php/* * Created on January 9, 2014 * Author: Mohammad Faisal Ahmed <faisal.ahmed0001@gmail.com> */function zohoMigratorStepTwoView($zoho_module_name, $error = '', $success = '') {    global $MULTIPLE_INSERT_NOT_ALLOWED_FOR_MODULE;    global $EXCLUDE_FIELDS;    $newConverter = new CsvConversion();    $csv_column_name = $newConverter->parse_csv_column();    $module_column_name = array();	$dataMigrationControllerObj = new ZohoDataSync();	$response = $dataMigrationControllerObj->getFields($zoho_module_name);    $xml = simplexml_load_string($response);    $mendatoryArray = '';    if ($dataMigrationControllerObj->errorFound($xml)) {    } else if ($xml !== false) {	    foreach ($xml->section as $sectionKey => $sectionValue) {            foreach ($sectionValue->FL as $key => $row) {                $temp_value = (string)$row['label'];                $dontAddThisField = 0;                foreach ($EXCLUDE_FIELDS as $exclude_fields_key => $exclude_fields_value) {                    if (strpos($temp_value, $exclude_fields_value) !== FALSE) {                        $dontAddThisField = 1;                        break;                    }                }                if ($dontAddThisField) {                    continue;                }                $fieldKey = str_replace(' ', '_', $temp_value);                $mendatory = '';                if ($row['req'] == 'true') {                    $mendatory = '<span style="color: red;font-size: 1.3em;font-weight: bolder;">*</span>';                    if ($mendatoryArray != '') $mendatoryArray .= (',"'.$fieldKey.'"');                    else $mendatoryArray .= ('"'.$fieldKey.'"');                }                $module_column_name[$fieldKey] = $temp_value . $mendatory;            }	    }	} else {        $error = "Error! Please check your daily API limits at Zoho.";    }?><div class="block" style="margin: 10px 20px 25px 0px; padding-bottom: 0px;">	<div class="block_head">		<div class="bheadl"></div>		<div class="bheadr"></div>		<h2 style="margin: 0;">Zoho Data Sync Automated Tools Settings</h2>		<h2 style="margin: 0; float: right;"><a href="#" onclick="location.reload(true);">Back to Step one</a></h2>	</div>	<div class="block_content">        <?php if ($success != '') { ?><div class="message success"><?php echo $success ?></div><?php } ?>        <?php if ($error != '') { ?><div class="message errormsg"><?php echo $error ?></div><?php } ?>        <?php if (count($module_column_name) > 0) { ?>        <form id="zds_file_upload_into_zoho" name="zds_file_upload_into_zoho" onsubmit="return validate_form_step_2();" method="post" action="">            <input type="hidden" name="zds_automated_hidden" value="step2"/>            <input type="hidden" name="zoho_module_name" value="<?php echo $zoho_module_name ?>"/>            <h3 style="text-decoration: underline;">Step Two</h3>            <h2>Map the Zoho CRM field names with the appropriate column names of the source file that you import.</h2>            <h3><span style="color: red;font-size: 1.3em;font-weight: bolder;">*</span> denotes the mandatory field.</h3>            <?php if (!in_array($zoho_module_name, $MULTIPLE_INSERT_NOT_ALLOWED_FOR_MODULE)) { ?>            <p>                <label>If record already exist<span style="color: red;font-size: 1.3em;font-weight: bolder;">*</span>:</label> <br />                <select name="duplicateCheck" class="styled">                    <option value="2">Update existing record</option>                    <option value="1">Ignore new record</option>                </select>            </p>            <?php } ?>            <?php foreach ($module_column_name as $key => $value) { ?>            <p style="padding: 0px;">                <label for="<?php echo $key ?>">For Zoho Field: <?php echo $value ?></label>                <select id="<?php echo $key ?>" class="styled" name="zoho_column_matching[<?php echo $key ?>]">                    <option selected="selected" value="">Source Column: None</option>                    <?php foreach ($csv_column_name as $key2 => $value2) { ?>                    <option value="<?php echo $key2 ?>">Source Column: <?php echo $value2 ?></option>                    <?php } ?>                </select>            </p>            <?php } ?>            <hr />            <p>                <input type="hidden" name="mendatoryArray" value="<?php echo str_replace('"', '', $mendatoryArray) ?>" />                <input type="submit" class="submit small" value="Submit" />            </p>        </form>        <?php } ?>	</div>	<div class="bendl"></div>	<div class="bendr"></div>	<div class="clear"></div></div><script type="text/javascript">    function validate_form_step_2(){        var mendatoryField = [<?php echo $mendatoryArray ?>];        for (var i = 0; i < mendatoryField.length; i++) {            var element = document.getElementById(mendatoryField[i]);            var value = element.options[element.selectedIndex].value;            if (value == '') {                alert('Please select the mendatory Zoho CRM field\'s value first.');                return false;            }        }        return true;    }</script><?php } ?>